<!DOCTYPE html>
<html>
<head>
  <title>GoodwillTracker</title>
  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>
  <script src="https://maps.googleapis.com/maps/api/js?key=<%= CONFIG[:google_api_key] %>&sensor=true">
  </script>
</head>

<body>
<div id="fb-root"></div>
<script>
  window.fbAsyncInit = function() {
    // init the FB JS SDK
    FB.init({
      appId      : "<%= CONFIG[:facebook_app_id] %>",                        // App ID from the app dashboard
      status     : true,                                 // Check Facebook Login status
      xfbml      : true                                  // Look for social plugins on the page
    });

    // Additional initialization code such as adding Event Listeners goes here
  };

  // Load the SDK asynchronously
  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/all.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>
<div id='overlay'></div>
<!-- Background for modal -->
<div class='container'>
  <!-- Modal window -->
  <div id='overlayWindow'></div>

  <!-- Login Controls -->
  <div id="user_nav">
    <% if current_user %>
      <p>Welcome, <%= current_user.name %></p>
      <%= link_to "Sign out", signout_path, id: "signout" %>
    <% else %>
      <!-- Makes a call to /auth/facebook to get oauth token which redirects back to /auth/facebook/callback -->
      <a href='/auth/facebook' id='signin'>Sign in with Facebook</a>
    <% end %>
  </div> <!-- end user-nav -->

  <%= yield %>

</div> <!-- end container -->
</body>

</html>
